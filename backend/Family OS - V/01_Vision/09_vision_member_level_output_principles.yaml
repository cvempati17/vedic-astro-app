# ============================================================
# member_level_output_contract.yaml
# Family OS â€“ Member-Level Output Contract (MLOC)
# ============================================================

member_level_output_contract:
  metadata:
    engine: Member_Level_Output_Contract
    version: "1.0.0"
    role: human_interface_layer
    scope: post_intervention_pre_ui
    purpose: >
      Converts family-level outcomes into clear, ethical,
      role-specific guidance for each family member.
      Ensures responsibility clarity, emotional safety,
      and non-transfer of guilt or excessive burden.

  ############################################################
  # 1. GLOBAL OUTPUT MODES (INHERITED)
  ############################################################

  inherited_modes:
    from:
      - system_modes
      - free_will_intervention_hook_layer
    applied_to:
      - tone
      - verbosity
      - ethical_guardrails

  ############################################################
  # 2. ROLE DEFINITIONS (CANONICAL)
  ############################################################

  roles:

    father:
      archetype: authority_stability_provider
      primary_domains:
        - responsibility_distribution
        - decision_framework
        - legacy_care_aging
      vulnerability_domains:
        - emotional_architecture
      ethical_limits:
        - cannot_transfer_unresolved_burden_to_children
        - must_respect_health_constraints

    mother:
      archetype: emotional_regulator_nurturer
      primary_domains:
        - emotional_architecture
        - conflict_repair
        - boundaries_dependency
      vulnerability_domains:
        - over-giving
        - emotional_enmeshment
      ethical_limits:
        - must_preserve_self_boundary
        - cannot_be_default_emotional_sink

    child_dependent:
      archetype: protected_developing_self
      primary_domains:
        - learning
        - identity_formation
      vulnerability_domains:
        - over-responsibilization
        - guilt_internalization
      ethical_limits:
        - cannot_be_primary_caregiver
        - cannot_be_decision_authority

    child_autonomous:
      archetype: emerging_contributor
      primary_domains:
        - responsibility_distribution
        - boundaries_dependency
      vulnerability_domains:
        - role_confusion
      ethical_limits:
        - responsibility_must_be_time_limited
        - autonomy_must_be_respected

  ############################################################
  # 3. MEMBER OUTPUT TEMPLATE (BASE)
  ############################################################

  base_member_output_template:
    fields:
      - role
      - current_system_mode
      - dominant_family_phase
      - personal_focus_areas
      - responsibilities
      - responsibilities_not_assigned
      - recommended_actions
      - acceptance_guidance
      - boundaries
      - cautions
      - time_horizon
      - emotional_support_note
      - audit_trace

  ############################################################
  # 4. ROLE-SPECIFIC OUTPUT ADAPTATION
  ############################################################

  role_specific_adaptation:

    father:
      responsibility_emphasis: duty_with_limits
      language_tone:
        normal: steady
        crisis: grounding
        recovery: reflective
      default_exclusions:
        - emotional_overexertion
      guidance_bias:
        acceptance_over_force: true

    mother:
      responsibility_emphasis: care_with_boundaries
      language_tone:
        normal: supportive
        crisis: protective
        recovery: restorative
      default_exclusions:
        - emotional_self-neglect
      guidance_bias:
        boundary_reinforcement: true

    child_dependent:
      responsibility_emphasis: safety_and_growth
      language_tone:
        all_modes: reassuring
      default_exclusions:
        - caregiving_duty
        - conflict_mediation
      guidance_bias:
        reassurance_over_action: true

    child_autonomous:
      responsibility_emphasis: contribution_with_choice
      language_tone:
        normal: empowering
        crisis: containing
        recovery: encouraging
      default_exclusions:
        - permanent_burden
      guidance_bias:
        consent_required: true

  ############################################################
  # 5. INTERVENTION TRANSLATION RULES
  ############################################################

  intervention_translation:

    - id: MLOC-INT-01
      if:
        recommendation_class == acceptance_first
      then:
        recommended_actions: []
        acceptance_guidance: emphasize

    - id: MLOC-INT-02
      if:
        recommendation_class == active_mitigation
        role in [father, mother]
      then:
        recommended_actions: allow
        effort_cap: medium

    - id: MLOC-INT-03
      if:
        role == child_dependent
      then:
        recommended_actions: []
        acceptance_guidance: reassure

  ############################################################
  # 6. RESPONSIBILITY SAFETY FILTERS
  ############################################################

  responsibility_safety_filters:

    - id: MLOC-SAFE-01
      rule: >
        No child may be assigned binding karmic responsibility.
      severity: fatal

    - id: MLOC-SAFE-02
      rule: >
        Emotional repair responsibility must be shared or externalized.
      severity: high

    - id: MLOC-SAFE-03
      rule: >
        Health-limited members cannot receive escalation directives.
      severity: fatal

  ############################################################
  # 7. COUNSELING vs DIAGNOSTIC OUTPUT SWITCH
  ############################################################

  output_mode_behavior:

    diagnostic:
      include:
        - responsibilities
        - boundaries
        - cautions
      exclude:
        - coaching_language
        - emotional_reassurance

    counseling:
      include:
        - emotional_support_note
        - reassurance
        - stepwise_actions
      exclude:
        - deterministic_language
        - blame_language

  ############################################################
  # 8. EXAMPLE OUTPUT STRUCTURE (FOR UI)
  ############################################################

  example_member_output:
    role: father
    current_system_mode: crisis
    personal_focus_areas:
      - decision_stabilization
      - health_preservation
    responsibilities:
      - maintain_structural_decisions
    responsibilities_not_assigned:
      - emotional_mediation
    recommended_actions:
      - decision_delay_window
    acceptance_guidance:
      - accept_limited_control
    boundaries:
      - delegate_emotional_labor
    cautions:
      - avoid_overexertion
    time_horizon: short_term
    emotional_support_note: >
      Stability is created by restraint, not force, in this phase.

  ############################################################
  # 9. OUTPUT CONTRACT GUARANTEES
  ############################################################

  guarantees:
    - no_guilt_transfer
    - no_fatalistic_language
    - no_role_confusion
    - explicit_non_responsibility_clauses
    - traceable_reasoning
