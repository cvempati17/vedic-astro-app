engine:
  name: vision_engine
  version: 1.0
  domain: family_vision
  description: >
    Determines the long-term directional intelligence of the family system.
    Vision represents meaning, future-orientation, and trans-generational intent.
    This engine does not predict outcomes; it models orientation and aspiration.

execution:
  stage: core_section
  order: 1
  depends_on:
    - house_level_abstraction_engine
    - planetary_strength_scoring_standard
    - nakshatra_level_modulation_layer
    - global_aspect_impact_modifiers

scope:
  levels:
    - family
    - father
    - mother
    - child

input_requirements:
  charts:
    - D1
    - D9
  dashas:
    optional: true
  required_fields:
    - lagna
    - moon
    - sun
    - jupiter
    - saturn
    - nakshatra

core_concept:
  definition: >
    Vision is the familyâ€™s shared capacity to imagine, commit to, and sustain
    a meaningful future beyond immediate survival.
  polarity:
    positive: clarity, purpose, continuity
    negative: confusion, drift, inherited aimlessness

vision_axes:
  - axis: meaning_vs_survival
    description: >
      Whether the family orients toward values and meaning
      or remains stuck in short-term survival logic.
  - axis: continuity_vs_fragmentation
    description: >
      Whether vision is shared across generations or fragmented.
  - axis: aspiration_vs_resignation
    description: >
      Whether the family believes in growth or accepts stagnation.

house_influences:
  primary:
    - house: 9
      role: philosophy_future_meaning
    - house: 5
      role: creative_projection_children
    - house: 11
      role: collective_goals
  secondary:
    - house: 1
      role: identity_alignment
    - house: 4
      role: emotional_security_base

planetary_roles:
  sun:
    role: core_direction_authority
    default_weight: 0.25
  jupiter:
    role: wisdom_expansion_ethics
    default_weight: 0.30
  moon:
    role: emotional_belief_system
    default_weight: 0.20
  saturn:
    role: sustainability_realism
    default_weight: 0.15
  mercury:
    role: articulation_of_vision
    default_weight: 0.10

nakshatra_modulation:
  enabled: true
  dimensions:
    - emotional_memory
    - inherited_belief_bias
    - aspiration_style

evaluation_steps:

  - step: extract_raw_indicators
    description: >
      Collects raw chart indicators relevant to vision.
    actions:
      - map_planets_to_houses
      - detect_house_strengths
      - fetch_planetary_strengths
      - attach_nakshatra_profiles

  - step: calculate_axis_scores
    description: >
      Computes base scores for each vision axis.
    axes_scoring:
      meaning_vs_survival:
        positive_conditions:
          - jupiter_strong_in_9_or_11
          - sun_connected_to_9
        negative_conditions:
          - moon_afflicted_in_4
          - saturn_dominant_without_jupiter_support
      continuity_vs_fragmentation:
        positive_conditions:
          - benefic_links_5_9
          - strong_11th_house
        negative_conditions:
          - nodes_afflicting_9_or_5
      aspiration_vs_resignation:
        positive_conditions:
          - jupiter_above_threshold
          - supportive_sun_saturn_relation
        negative_conditions:
          - saturn_overpowering_sun
          - repeated_dasha_failures_flag

  - step: apply_aspect_modifiers
    description: >
      Adjusts axis scores based on aspect perception.
    use_files:
      - vision_aspect_modifiers.yaml
      - vision_engine_aspect_modifiers.yaml

  - step: apply_planetary_strength_modifiers
    description: >
      Scales scores by planetary strength and dignity.
    use_files:
      - vision_planetary_strength_aspect_modifiers.yaml
      - vision_planetary_strength_scoring.yaml

  - step: apply_nakshatra_modulation
    description: >
      Modulates lived experience of vision.
    effects:
      - soften_or_intensify_aspiration
      - convert_idealism_to_practicality
      - convert_confusion_to_seeking

  - step: derive_narrative
    description: >
      Converts scores into human-readable insight.
    narrative_templates:
      high_alignment: >
        The family carries a clear sense of direction and shared purpose,
        allowing members to act with confidence and continuity.
      moderate_alignment: >
        The family possesses aspiration but may experience periods of
        confusion or misalignment that require conscious recalibration.
      low_alignment: >
        Vision within the family is fragmented or inherited through struggle,
        requiring intentional effort to define shared meaning.

  - step: generate_guidance
    description: >
      Provides non-fatalistic, actionable guidance.
    guidance_rules:
      if_high_alignment:
        - protect_long_term_goals
        - mentor_next_generation
      if_moderate_alignment:
        - align_decisions_to_core_values
        - clarify_shared_future
      if_low_alignment:
        - pause_major_decisions
        - rebuild_philosophical_foundation

  - step: tag_risks
    description: >
      Flags common vision-related risks.
    risk_tags:
      - inherited_confusion
      - idealism_without_structure
      - survival_dominant_thinking

  - step: output_contract_mapping
    description: >
      Maps engine output to member-level output contract.
    output_fields:
      narrative: derived_narrative
      scores:
        alignment: normalized_vision_score
      guidance: guidance_list
      timeline: optional_dasha_projection

free_will_hooks:
  enabled: true
  hooks:
    - condition: low_alignment
      recommendation: >
        Conscious articulation of shared family values
        significantly improves long-term outcomes.
    - condition: moderate_alignment
      recommendation: >
        Periodic reflection and recalibration prevents drift.
    - condition: high_alignment
      recommendation: >
        Maintain humility and adaptability to avoid rigidity.

ethical_constraints:
  - no_predictions
  - no_fatalistic_language
  - no_value_judgment

engine_output:
  severity_scale: 0_to_100
  normalization: percentile
  default_visibility: true
